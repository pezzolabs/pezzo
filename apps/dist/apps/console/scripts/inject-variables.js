const fs=require("fs"),ENV_VARIABLE_PREFIX_REGEXP=/^NX_/,HTML_HEAD_CLOSING_TAG="</head>";if(require.main===module){const[,,e]=process.argv;if(!e)throw new Error("Must pass one argument: HTML_FILE");injectVariables(process.env,e).catch((e=>{console.error(e),process.exit(1)}))}async function injectVariables(e,t){const r=getReactAppEnv(e),i=await fs.promises.readFile(t,"utf-8"),n=createScript(r),a=i.replace("</head>",n+"</head>");await fs.promises.writeFile(t,a),console.info("Updated environment variables")}function createScript(e){return`<script>Object.assign(window, ${JSON.stringify(e)})<\/script>`}function getReactAppEnv(e){const t=Object.fromEntries(Object.entries(e).filter((([e])=>e.match(ENV_VARIABLE_PREFIX_REGEXP))));return console.log(`Replacing environment variable "${e}" with value ${t}`),t}exports.injectVariables=injectVariables,exports.createScript=createScript,exports.getReactAppEnv=getReactAppEnv;